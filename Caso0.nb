(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13284,        381]
NotebookOptionsPosition[     12362,        358]
NotebookOutlinePosition[     12703,        373]
CellTagsIndexPosition[     12660,        370]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\

Caso 0: Modelado Firewall\
\>", "Title",
 CellChangeTimes->{{3.725018546690049*^9, 
  3.7250185910420017`*^9}},ExpressionUUID->"31da8479-ca36-41ff-8b77-\
464a08f14a4d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"<<", "/home/pablo/Escritorio/Uni/RRT/RandomData.m"}]}]], "Input",
 CellChangeTimes->{{3.7250185936126547`*^9, 
  3.7250186490407953`*^9}},ExpressionUUID->"e77b4df2-1292-414c-9a45-\
97b3a30b6bee"],

Cell["\<\
Se calculan las probabilidades de estado en funci\[OAcute]n de Lambda (tasa \
de llegada de los paquetes al firewall), mu (tasa de servicio del paquete al \
enlace) y r (tasa de comprobaci\[OAcute]n de reglas)
\
\>", "Text",
 CellChangeTimes->{{3.725018700839509*^9, 
  3.7250188016635036`*^9}},ExpressionUUID->"dd1afaab-19e8-46cb-9c9f-\
657367c81a89"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lambda", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"r", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ene", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ka", "=", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"0", "*", "i", "*", "j"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "ka"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "ene"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c1", "=", 
   RowBox[{"lambda", "/", "mu"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c2", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lambda", "+", "mu"}], ")"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c3", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lambda", "+", "r"}], ")"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c4", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"lambda", "+", "r"}], ")"}], "/", "mu"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c5", "=", 
   RowBox[{"lambda", "/", "r"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"c6", "=", 
    RowBox[{"mu", "/", "r"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", "ene"}], "]"}], "]"}], "=", "c1"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"[", 
     RowBox[{"1", ",", 
      RowBox[{"ene", "-", "1"}]}], "]"}], "]"}], "=", 
   RowBox[{"c2", "*", 
    RowBox[{"P", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "ene"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", 
     RowBox[{"ene", "-", "1"}]}], ",", 
    RowBox[{"i", ">", "1"}], ",", 
    RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"P", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", 
        RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "=", 
     RowBox[{"c3", "*", 
      RowBox[{"P", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "i"}], "]"}], "]"}]}]}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"[", 
     RowBox[{"2", ",", "ene"}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"c4", "*", 
     RowBox[{"P", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "-", "c1"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "2"}], ",", 
    RowBox[{"i", "<", "ka"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", 
         RowBox[{"ene", "-", "1"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"c2", "*", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "ene"}], "]"}], "]"}]}], "-", 
       RowBox[{"c5", "*", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "ene"}], "]"}], "]"}]}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", 
        RowBox[{"ene", "-", "1"}]}], ",", 
       RowBox[{"j", ">", "1"}], ",", 
       RowBox[{"j", "--"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"P", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", 
            RowBox[{"j", "-", "1"}]}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"c3", "*", 
           RowBox[{"P", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], "-", 
          RowBox[{"c5", "*", 
           RowBox[{"P", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"i", "-", "1"}], ",", "j"}], "]"}], "]"}]}]}]}], 
        ";"}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"i", "+", "1"}], ",", "ene"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"c4", "*", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "-", 
       RowBox[{"c1", "*", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}]}]}], ";"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"P", "[", 
    RowBox[{"[", 
     RowBox[{"ka", ",", 
      RowBox[{"ene", "-", "1"}]}], "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"c6", "*", 
     RowBox[{"P", "[", 
      RowBox[{"[", 
       RowBox[{"ka", ",", "ene"}], "]"}], "]"}]}], "-", 
    RowBox[{"c5", "*", 
     RowBox[{"P", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"ka", "-", "1"}], ",", "ene"}], "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", 
     RowBox[{"ene", "-", "1"}]}], ",", 
    RowBox[{"i", ">", "1"}], ",", 
    RowBox[{"i", "--"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"P", "[", 
       RowBox[{"[", 
        RowBox[{"ka", ",", 
         RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"c6", "*", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{"ka", ",", "ene"}], "]"}], "]"}]}], "-", 
       RowBox[{"c5", "*", 
        RowBox[{"P", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"ka", "-", "1"}], ",", "i"}], "]"}], "]"}]}]}]}], ";"}]}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"p0", "=", 
  RowBox[{
   RowBox[{"1", "/", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"Total", "[", 
       RowBox[{"Flatten", "[", "P", "]"}], "]"}]}], ")"}]}], "//", 
   "N"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{
    RowBox[{"p0", "*", "P"}], "//", "N"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "P", "]"}], "//", "N"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p0", "+", 
   RowBox[{"Total", "[", 
    RowBox[{"Flatten", "[", "P", "]"}], "]"}]}], "//", "N"}]}], "Input",
 CellChangeTimes->{{3.725018653055922*^9, 3.7250186819841423`*^9}, {
   3.725018806303043*^9, 3.72501882190685*^9}, {3.725019045144226*^9, 
   3.725019078206994*^9}, {3.7250191458868628`*^9, 3.725019314249023*^9}, {
   3.725019395218236*^9, 3.725019420731035*^9}, {3.7250194523965607`*^9, 
   3.725019718287561*^9}, {3.725019755914301*^9, 3.725019822887476*^9}, {
   3.725019871482428*^9, 3.725019934760336*^9}, 3.72501999140217*^9, {
   3.725020073495994*^9, 3.725020139952167*^9}, {3.725020196269148*^9, 
   3.7250204921962843`*^9}, {3.725020549351348*^9, 3.7250205818914003`*^9}, {
   3.72502106125311*^9, 3.7250211355315866`*^9}, {3.725021174395854*^9, 
   3.725021242211681*^9}, {3.725021286219843*^9, 3.725021326980385*^9}, {
   3.725021359595017*^9, 3.725021444217482*^9}, {3.725021476136492*^9, 
   3.7250214950130663`*^9}, {3.7250215254765377`*^9, 3.72502153498755*^9}, {
   3.7250215785937147`*^9, 3.725021599934647*^9}, {3.725021681976185*^9, 
   3.725021697074327*^9}, {3.7250217382604103`*^9, 3.725021745361223*^9}, {
   3.7250218181798973`*^9, 3.725021818402861*^9}, {3.725021943859742*^9, 
   3.725021952070734*^9}, {3.725022027331765*^9, 3.7250220866540403`*^9}, {
   3.7250221544544067`*^9, 3.725022215367229*^9}, {3.725022264621068*^9, 
   3.725022280439608*^9}, 3.7250227360748787`*^9, {3.72502280672805*^9, 
   3.725022806831316*^9}},ExpressionUUID->"4dbfa38d-564b-45a1-a881-\
3f988b10dc36"],

Cell[BoxData["5.500698329295759`*^-6"], "Output",
 CellChangeTimes->{
  3.725021854486759*^9, 3.7250219601256733`*^9, {3.725022030554653*^9, 
   3.725022088805181*^9}, {3.72502220013717*^9, 3.7250222164722443`*^9}, 
   3.7250222882111073`*^9, 3.7250227377936153`*^9, 
   3.7250228078916397`*^9},ExpressionUUID->"39aeb0b3-80a3-4261-a430-\
76b3f31244f9"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"8.050088648313368`*^-6", "5.750063320223833`*^-6", 
      "4.107188085874167`*^-6", "2.933705775624405`*^-6", 
      "1.833566109765253`*^-6"},
     {"0.000024270940607153865`", "0.000018979261382316713`", 
      "0.000014730097583333129`", "0.000011359699923987779`", 
      "7.558203979933675`*^-6"},
     {"0.0000794955088863632`", "0.00006220515245663563`", 
      "0.00004864085106426348`", "0.00003798909359561328`", 
      "0.000025632734492241724`"},
     {"0.0002616280070336339`", "0.00020465004858306293`", 
      "0.00016007599214912024`", "0.00012519402113383255`", 
      "0.00008465444683170577`"},
     {"0.0008611830999075102`", "0.0006736022281005252`", 
      "0.0005268804464001238`", "0.0004121128963240406`", 
      "0.0002787341719104518`"},
     {"0.0028346817157481933`", "0.002217230433563145`", 
      "0.0017342732943737107`", "0.0013565131806452333`", 
      "0.0009175042808808836`"},
     {"0.009330660694417778`", "0.00729825204845931`", 
      "0.005708543833006283`", "0.004465106503760269`", 
      "0.003020067635070389`"},
     {"0.030712870862224937`", "0.024022979772577613`", 
      "0.01879028378984295`", "0.014697375993819324`", 
      "0.009940876904904677`"},
     {"0.10109470860018634`", "0.07907421464944099`", "0.061850234403841554`",
       "0.04837798914383519`", "0.032721462441123166`"},
     {"0.0976177578355945`", "0.10450734993383426`", "0.10989624803783682`", 
      "0.11615885871892162`", "0.10770620307947576`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.725021854486759*^9, 3.7250219601256733`*^9, {3.725022030554653*^9, 
   3.725022088805181*^9}, {3.72502220013717*^9, 3.7250222164722443`*^9}, 
   3.7250222882111073`*^9, 3.7250227377936153`*^9, 
   3.725022807897336*^9},ExpressionUUID->"5792e4c1-ab77-4b91-ad5f-\
dc7a5ee3a8e2"],

Cell[BoxData["0.9999999999999998`"], "Output",
 CellChangeTimes->{
  3.725021854486759*^9, 3.7250219601256733`*^9, {3.725022030554653*^9, 
   3.725022088805181*^9}, {3.72502220013717*^9, 3.7250222164722443`*^9}, 
   3.7250222882111073`*^9, 3.7250227377936153`*^9, 
   3.7250228078996553`*^9},ExpressionUUID->"b7629053-357b-4341-92e9-\
f8f402808412"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{648, 716},
WindowMargins->{{252, Automatic}, {-42, Automatic}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 179, 6, 160, "Title",ExpressionUUID->"31da8479-ca36-41ff-8b77-464a08f14a4d"],
Cell[762, 30, 253, 5, 55, "Input",ExpressionUUID->"e77b4df2-1292-414c-9a45-97b3a30b6bee"],
Cell[1018, 37, 362, 8, 81, "Text",ExpressionUUID->"dd1afaab-19e8-46cb-9c9f-657367c81a89"],
Cell[CellGroupData[{
Cell[1405, 49, 7886, 238, 745, "Input",ExpressionUUID->"4dbfa38d-564b-45a1-a881-3f988b10dc36"],
Cell[9294, 289, 352, 6, 37, "Output",ExpressionUUID->"39aeb0b3-80a3-4261-a430-76b3f31244f9"],
Cell[9649, 297, 2333, 49, 217, "Output",ExpressionUUID->"5792e4c1-ab77-4b91-ad5f-dc7a5ee3a8e2"],
Cell[11985, 348, 349, 6, 68, "Output",ExpressionUUID->"b7629053-357b-4341-92e9-f8f402808412"]
}, Open  ]]
}, Open  ]]
}
]
*)

