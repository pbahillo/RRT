(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     14519,        390]
NotebookOptionsPosition[     12642,        354]
NotebookOutlinePosition[     12979,        369]
CellTagsIndexPosition[     12936,        366]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"<<", " ", "\"\</home/pablo/Escritorio/Uni/RRT/RandomData.m\>\""}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"RandomData", "[", "]"}], "\[IndentingNewLine]", 
 RowBox[{"RandomExp", "[", "100", "]"}], "\n", 
 RowBox[{"Histogram", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomData", "[", "]"}], ",", 
    RowBox[{"{", "30000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"RandomExp", "[", "100", "]"}], ",", 
    RowBox[{"{", "30000", "}"}]}], "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histogram", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomExp", "[", "100", "]"}], ",", 
     RowBox[{"{", "30000", "}"}]}], "]"}], ",", " ", "50", ",", 
   "\"\<CDF\>\""}], "]"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.716637714810349*^9, 3.716637733991438*^9}, {
   3.716639136312948*^9, 3.7166393126531487`*^9}, {3.716639358792038*^9, 
   3.716639365630739*^9}, {3.716639417263846*^9, 3.716639448145926*^9}, {
   3.7166395480272512`*^9, 3.716639564445861*^9}, {3.716639606740562*^9, 
   3.716639607004672*^9}, {3.7166397108653603`*^9, 3.71663989383169*^9}, {
   3.7166404107355623`*^9, 3.716640421613041*^9}, 3.720178804521207*^9, 
   3.720178902025359*^9, 3.72017893701616*^9, 
   3.720179011496272*^9},ExpressionUUID->"402f1293-022a-454c-8e99-\
e9ef56b66138"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FifoSchedulling", "[", 
   RowBox[{"arrivals_", ",", "service_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "checkTime"}], "}"}], ",", 
    RowBox[{
     RowBox[{"n", "=", "1"}], ";", 
     RowBox[{"checkTime", "=", 
      RowBox[{"arrivals", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"checkTime", "\[GreaterEqual]", "#"}], ",", 
          RowBox[{"checkTime", "+=", 
           RowBox[{"service", "[", 
            RowBox[{"[", 
             RowBox[{"n", "++"}], "]"}], "]"}]}], ",", 
          RowBox[{"checkTime", "=", 
           RowBox[{"#", "+", 
            RowBox[{"service", "[", 
             RowBox[{"[", 
              RowBox[{"n", "++"}], "]"}], "]"}]}]}]}], "]"}], ")"}], "&"}], "/@",
       "arrivals"}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.716641405776621*^9, 3.71664141490219*^9}, 
   3.716641448042288*^9, {3.7201791823024063`*^9, 
   3.720179188133071*^9}},ExpressionUUID->"d27bd70d-34a1-45b4-a630-\
273d7a51365f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmax", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ro", "=", "0.8"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", "=", 
   RowBox[{"mu", "*", "ro"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InterArrivalsTime", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomExp", "[", "lambda", "]"}], ",", 
     RowBox[{"{", "nmax", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ArrivalsTime", "=", 
   RowBox[{"Accumulate", "[", "InterArrivalsTime", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ServiceTime", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"RandomExp", "[", "mu", "]"}], ",", 
     RowBox[{"{", "nmax", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"DepartureTime", "=", 
   RowBox[{"FifoSchedulling", "[", 
    RowBox[{"ArrivalsTime", ",", " ", "ServiceTime"}], "]"}]}], 
  ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{
  3.7166405842721786`*^9, {3.71664087489624*^9, 3.716640947795299*^9}, {
   3.716641020113203*^9, 3.716641143897629*^9}, {3.716641197133106*^9, 
   3.7166412212503777`*^9}, 3.716641383141118*^9, {3.716641441972028*^9, 
   3.716641457624558*^9}, 3.716641680323038*^9, {3.7166420030936823`*^9, 
   3.71664201724842*^9}, {3.7172429883819323`*^9, 3.717242989807662*^9}, 
   3.717243064868202*^9},ExpressionUUID->"2f0622c2-28a7-489d-b168-\
1cf600686bb4"],

Cell[BoxData[
 RowBox[{"ListPlot", "[", 
  RowBox[{"{", 
   RowBox[{"ArrivalsTime", ",", "DepartureTime"}], "}"}], "]"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.716641459488551*^9, 3.7166415388121862`*^9}, {
  3.716641590211883*^9, 3.716641605632762*^9}, {3.716641983935989*^9, 
  3.7166419954551897`*^9}, {3.716642154984456*^9, 3.716642263302412*^9}, {
  3.72017902826213*^9, 
  3.7201790355612*^9}},ExpressionUUID->"7e71e59c-270e-4a0d-9b3a-0ae2a0dd265e"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListPlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ArrivalsTime", "[", 
       RowBox[{"[", 
        RowBox[{"origin", ";;", 
         RowBox[{"origin", "+", "width"}]}], "]"}], "]"}], ",", 
      RowBox[{"DepartureTime", "[", 
       RowBox[{"[", 
        RowBox[{"origin", ";;", 
         RowBox[{"origin", "+", "width"}]}], "]"}], "]"}]}], "}"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"origin", ",", "1", ",", 
     RowBox[{"1000", "-", "width"}], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"width", ",", "10", ",", "40", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.717242834916193*^9, 3.7172428621362677`*^9}, {
  3.717242944709597*^9, 3.717242960834074*^9}, {3.7201790282624283`*^9, 
  3.720179041326679*^9}},ExpressionUUID->"eabd8f38-1716-43b9-b4c0-\
1d843939afda"],

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PointStair", "[", 
       RowBox[{"ArrivalsTime", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "width"}], "]"}], "]"}], "]"}], ",", 
      RowBox[{"PointStair", "[", 
       RowBox[{"DepartureTime", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "width"}], "]"}], "]"}], "]"}]}], "}"}], "]"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"width", ",", "10", ",", "40", ",", "1"}], "}"}]}], 
  "]"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.717243364492407*^9, 3.717243465195713*^9}, {
   3.717243497662732*^9, 3.717243543507906*^9}, {3.717243582436517*^9, 
   3.717243671208488*^9}, {3.717243748123233*^9, 3.717243768264473*^9}, 
   3.7201791027140083`*^9},ExpressionUUID->"7d2f3daa-0075-44ca-8aa4-\
63be2cb98373"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ArrivalsEvent", "[", "lst_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", "1"}], "}"}], "&"}], ",", "lst"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"DepartureEvent", "[", "lst_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"#", ",", 
       RowBox[{"-", "1"}]}], "}"}], "&"}], ",", "lst"}], "]"}]}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.717244169502385*^9, 3.7172442593751593`*^9}, 
   3.720179137755719*^9, 
   3.72017921772961*^9},ExpressionUUID->"4606cf56-dad3-41f5-8b24-\
33dea03e9bd4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"ArrivalsEvent", "[", "ArrivalsTime", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"DepartureEvent", "[", "DepartureTime", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EventList", "=", 
   RowBox[{"Sort", "[", 
    RowBox[{"Join", "[", 
     RowBox[{"A", ",", "B"}], "]"}], "]"}]}], ";"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.717244264266446*^9, 3.717244310565853*^9}, {
   3.717244360919283*^9, 3.7172444569500227`*^9}, 3.72017913775592*^9, {
   3.720179207722299*^9, 
   3.720179214323497*^9}},ExpressionUUID->"7f025dd6-4d3e-4b8f-842b-\
ad2dcde27747"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DrawMountain", "[", "lst_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"n", "=", "0"}], ",", 
      RowBox[{"lastTime", "=", "0"}]}], "}"}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"Map", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"lastTime", ",", "n"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"lastTime", "=", 
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], ",", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"#", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "1"}], ",", 
               RowBox[{"n", "++"}], ",", 
               RowBox[{"n", "--"}]}], "]"}]}], "}"}]}], "}"}], "&"}], ",", 
        "lst"}], "]"}], ",", "1"}], "]"}]}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"listStat", "=", 
   RowBox[{"DrawMountain", "[", "EventList", "]"}]}], ";"}], "\n", 
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"ListLinePlot", "[", 
    RowBox[{"listStat", "[", 
     RowBox[{"[", 
      RowBox[{"1", ";;", "width"}], "]"}], "]"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"width", ",", "10", ",", "1000", ",", "1"}], "}"}]}], 
  "]"}]}], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.71724447097396*^9, 3.717244483177079*^9}, {
   3.7172446480575733`*^9, 3.717244672775654*^9}, 3.720179137756185*^9, 
   3.720179203678684*^9},ExpressionUUID->"76b07f40-8531-4bb8-be0c-\
4d31cfe4e0e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GetProb", "[", 
   RowBox[{"n_", ",", "lst_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"time", "=", "0"}], ",", 
      RowBox[{"lastTime", "=", "0"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "n"}], ",", 
            RowBox[{"time", "+=", 
             RowBox[{
              RowBox[{"#", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "-", "lastTime"}]}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"lastTime", "=", 
           RowBox[{"#", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "&"}], ",", "lst"}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"time", "/", 
      RowBox[{
       RowBox[{"Last", "[", "lst", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}]}]}], "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.717246629291431*^9, 3.717246669581861*^9}, {
   3.71724670299541*^9, 3.717247040431366*^9}, 3.720179165584774*^9, 
   3.720179233224926*^9},ExpressionUUID->"885643f1-5eb5-46d2-9ed6-\
8433aaaaf63c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GetProb", "[", 
    RowBox[{"0", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"1", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"2", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"3", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"4", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"5", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"6", ",", "listStat"}], "]"}], "+", 
   RowBox[{"GetProb", "[", 
    RowBox[{"7", ",", "listStat"}], "]"}]}], "\[IndentingNewLine]"}]], "Input",\

 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.717247047241952*^9, 3.717247136864162*^9}, 
   3.7201791755803547`*^9},ExpressionUUID->"91b87dc0-e1cb-44e1-abdf-\
8d4ace8f497f"]
}, Open  ]]
},
WindowSize->{648, 716},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
FrontEndVersion->"11.2 for Linux x86 (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 1467, 32, 147, "Input",ExpressionUUID->"402f1293-022a-454c-8e99-e9ef56b66138",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2050, 56, 1232, 33, 124, "Input",ExpressionUUID->"d27bd70d-34a1-45b4-a630-273d7a51365f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[3285, 91, 1557, 39, 193, "Input",ExpressionUUID->"2f0622c2-28a7-489d-b168-1cf600686bb4",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[4845, 132, 504, 9, 31, "Input",ExpressionUUID->"7e71e59c-270e-4a0d-9b3a-0ae2a0dd265e",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[5352, 143, 943, 25, 101, "Input",ExpressionUUID->"eabd8f38-1716-43b9-b4c0-1d843939afda",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[6298, 170, 933, 23, 78, "Input",ExpressionUUID->"7d2f3daa-0075-44ca-8aa4-63be2cb98373",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7234, 195, 706, 21, 55, "Input",ExpressionUUID->"4606cf56-dad3-41f5-8b24-33dea03e9bd4",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[7943, 218, 721, 19, 78, "Input",ExpressionUUID->"7f025dd6-4d3e-4b8f-842b-ad2dcde27747",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[8667, 239, 1677, 47, 216, "Input",ExpressionUUID->"76b07f40-8531-4bb8-be0c-4d31cfe4e0e9",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[10347, 288, 1387, 38, 124, "Input",ExpressionUUID->"885643f1-5eb5-46d2-9ed6-8433aaaaf63c",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[11737, 328, 889, 23, 124, "Input",ExpressionUUID->"91b87dc0-e1cb-44e1-abdf-8d4ace8f497f",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]]
}
]
*)

